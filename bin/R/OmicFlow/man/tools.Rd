% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tools-class.R
\name{tools}
\alias{tools}
\title{Abstract 'tools' class}
\description{
This is the abstract class 'tools', contains a variety of methods that are inherited and applied in the omics classes:
\link[OmicFlow]{metataxonomics}, transcriptomics, metabolomics and proteomics.
}
\details{
Every class is created with the \link[R6]{R6Class} method. Methods are either public or private, and only the public components are inherited by other omics classes.
The tools class by default uses triplet \link[data.table]{data.table} data structures for quick and efficient data manipulation and returns the object by reference, same as the R6 class.
The method by reference is very efficient when dealing with big data.
}
\examples{

## ------------------------------------------------
## Method `tools$removeZeros`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$removeZeros()

## ------------------------------------------------
## Method `tools$removeNAs`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$removeNAs(sample.id = "SAMPLE-ID", column = "treatment")


## ------------------------------------------------
## Method `tools$feature_subset`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$feature_subset(rank1 == "Streptococcus")
obj$feature_subset(rank1 \%in\% c("Streptococcus", "uncultured"))

## ------------------------------------------------
## Method `tools$sample_subset`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$sample_subset(cycle == "t1")
obj$sample_subset(cycle \%in\% c("t1", "t5"))

## ------------------------------------------------
## Method `tools$feature_glom`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$feature_glom(feature_rank = "Rank1")
obj$feature_glom(feature_rank = "Genus", feature_filter = c("uncultured", "metagenome"))

## ------------------------------------------------
## Method `tools$transform`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$transform(log2)


## ------------------------------------------------
## Method `tools$normalize`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$normalize()


## ------------------------------------------------
## Method `tools$rankstat`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
plt <- obj$rankstat()
plt

## ------------------------------------------------
## Method `tools$alpha_diversity`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
plt <- obj$alpha_diversity(col_name = "treatment",
                           method = "shannon")


## ------------------------------------------------
## Method `tools$composition`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

result <- obj$composition(feature_rank = "Genus",
                          feature_filter = c("uncultured"),
                          feature_top = 10)

plt <- composition_plot(data = result$data,
                        palette = result$palette,
                        feature_rank = "Genus")


## ------------------------------------------------
## Method `tools$ordination`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

pcoa_plots <- obj$ordination(metric = "bray",
                             method = "pcoa",
                             group_by = "treatment",
                             sample.id = "SAMPLE-ID",
                             weighted = TRUE,
                             parallel = TRUE,
                             normalize = TRUE)
pcoa_plots


## ------------------------------------------------
## Method `tools$differential_feature_expression`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

unpaired <- obj$differential_feature_expression(feature_rank = "Genus",
                                                sample.id = "SAMPLE-ID",
                                                paired = FALSE,
                                                condition.group = "treatment",
                                                condition_A = c("H"),
                                                condition_B = c("T"))

paired <- obj$differential_feature_expression(feature_rank = "Genus",
                                              sample.id = "SAMPLE-ID",
                                              paired = TRUE,
                                              condition.group = "cycle",
                                              condition_A = c("t2", "t3"),
                                              condition_B = c("t1", "t2"),
                                              feature_top = 20)


## ------------------------------------------------
## Method `tools$correlation`
## ------------------------------------------------

obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

plt <- obj$correlation(feature_rank = "Genus",
                       feature_filter = c("uncultured"),
                       sample.id = "SAMPLE-ID",
                       cor_method = "spearman",
                       cor_columns = c("BMI", "weight", "flight.time"),
                       cor_threshold = 0.8)

}
\seealso{
\link[OmicFlow]{diversity_plot}

\link[OmicFlow]{composition_plot}

\link[OmicFlow]{ordination_plot}, \link[OmicFlow]{stats_plot}, \link[OmicFlow]{pairwise_anosim}, \link[OmicFlow]{pairwise_adonis}

\link[OmicFlow]{volcano_plot}, \link[OmicFlow]{ViolinBoxPlot}, \link[OmicFlow]{paired_fold}, \link[OmicFlow]{unpaired_fold}
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{countData}}{A path to an existing file, data.table or data.frame.}

\item{\code{featureData}}{A path to an existing file, data.table or data.frame.}

\item{\code{metaData}}{A path to an existing file, data.table or data.frame.}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-tools-new}{\code{tools$new()}}
\item \href{#method-tools-removeZeros}{\code{tools$removeZeros()}}
\item \href{#method-tools-removeNAs}{\code{tools$removeNAs()}}
\item \href{#method-tools-feature_subset}{\code{tools$feature_subset()}}
\item \href{#method-tools-sample_subset}{\code{tools$sample_subset()}}
\item \href{#method-tools-feature_glom}{\code{tools$feature_glom()}}
\item \href{#method-tools-transform}{\code{tools$transform()}}
\item \href{#method-tools-normalize}{\code{tools$normalize()}}
\item \href{#method-tools-rankstat}{\code{tools$rankstat()}}
\item \href{#method-tools-alpha_diversity}{\code{tools$alpha_diversity()}}
\item \href{#method-tools-composition}{\code{tools$composition()}}
\item \href{#method-tools-ordination}{\code{tools$ordination()}}
\item \href{#method-tools-differential_feature_expression}{\code{tools$differential_feature_expression()}}
\item \href{#method-tools-triplot}{\code{tools$triplot()}}
\item \href{#method-tools-correlation}{\code{tools$correlation()}}
\item \href{#method-tools-label_phylo}{\code{tools$label_phylo()}}
\item \href{#method-tools-autoFlow}{\code{tools$autoFlow()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-new"></a>}}
\if{latex}{\out{\hypertarget{method-tools-new}{}}}
\subsection{Method \code{new()}}{
Wrapper function that is inherited and adapted for each omics class.
To create a new object use \code{tools$new()}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$new(countData = NA, featureData = NA, metaData = NA)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{countData}}{countData A path to an existing file, data.table or data.frame.}

\item{\code{featureData}}{A path to an existing file, data.table or data.frame.}

\item{\code{metaData}}{A path to an existing file, data.table or data.frame.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new \code{tools} object.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-removeZeros"></a>}}
\if{latex}{\out{\hypertarget{method-tools-removeZeros}{}}}
\subsection{Method \code{removeZeros()}}{
Removes empty (zero) values by row and column.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$removeZeros()}\if{html}{\out{</div>}}
}

\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$removeZeros()
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-removeNAs"></a>}}
\if{latex}{\out{\hypertarget{method-tools-removeNAs}{}}}
\subsection{Method \code{removeNAs()}}{
Remove NAs from metaData and updates the countData object fields
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$removeNAs(sample.id, column)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{sample.id}}{The column containing sample-id that are also the countData columns.}

\item{\code{column}}{The column from where NAs should be removed.}
}
\if{html}{\out{</div>}}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$removeNAs(sample.id = "SAMPLE-ID", column = "treatment")

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-feature_subset"></a>}}
\if{latex}{\out{\hypertarget{method-tools-feature_subset}{}}}
\subsection{Method \code{feature_subset()}}{
Feature subset (based on featureData), automatically applies \code{removeZeros}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$feature_subset(...)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{...}}{Expressions that return a logical value, and are defined in terms of the variables in featureData.
Only rows for which all conditions evaluate to TRUE are kept.}
}
\if{html}{\out{</div>}}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$feature_subset(rank1 == "Streptococcus")
obj$feature_subset(rank1 \%in\% c("Streptococcus", "uncultured"))
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-sample_subset"></a>}}
\if{latex}{\out{\hypertarget{method-tools-sample_subset}{}}}
\subsection{Method \code{sample_subset()}}{
Sample subset (based on metaData), automatically applies \code{removeZeros}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$sample_subset(...)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{...}}{Expressions that return a logical value, and are defined in terms of the variables in metaData.
Only rows for which all conditions evaluate to TRUE are kept.}
}
\if{html}{\out{</div>}}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$sample_subset(cycle == "t1")
obj$sample_subset(cycle \%in\% c("t1", "t5"))
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-feature_glom"></a>}}
\if{latex}{\out{\hypertarget{method-tools-feature_glom}{}}}
\subsection{Method \code{feature_glom()}}{
Agglomerates features by column, automatically applies \code{removeZeros}.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$feature_glom(feature_rank, feature_filter = NA)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature_rank}}{Column name to agglomerate.}

\item{\code{feature_filter}}{Removes features by name, works on single strings or vector of strings.}
}
\if{html}{\out{</div>}}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$feature_glom(feature_rank = "Rank1")
obj$feature_glom(feature_rank = "Genus", feature_filter = c("uncultured", "metagenome"))
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-transform"></a>}}
\if{latex}{\out{\hypertarget{method-tools-transform}{}}}
\subsection{Method \code{transform()}}{
Performs transformation on countData as a Triplet sparse matrix \link[Matrix]{uniqTsparse}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$transform(fun)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{fun}}{A function such as \code{log2}, \code{log}}
}
\if{html}{\out{</div>}}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$transform(log2)

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-normalize"></a>}}
\if{latex}{\out{\hypertarget{method-tools-normalize}{}}}
\subsection{Method \code{normalize()}}{
Relative abundance computation by column sums.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$normalize()}\if{html}{\out{</div>}}
}

\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
obj$normalize()

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-rankstat"></a>}}
\if{latex}{\out{\hypertarget{method-tools-rankstat}{}}}
\subsection{Method \code{rankstat()}}{
Rank statistics based on featureData
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$rankstat()}\if{html}{\out{</div>}}
}

\subsection{Details}{
Counts the number of features identified for each column, for example in case of 16S metagenomics it would be the number of OTUs or ASVs on different taxonomy levels.
}

\subsection{Returns}{
A \link[ggplot2]{ggplot} object.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
plt <- obj$rankstat()
plt
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-alpha_diversity"></a>}}
\if{latex}{\out{\hypertarget{method-tools-alpha_diversity}{}}}
\subsection{Method \code{alpha_diversity()}}{
Alpha diversity based on \link[vegan]{diversity}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$alpha_diversity(
  col_name,
  method = c("shannon", "invsimpson", "simpson"),
  Brewer.palID = "Set2",
  evenness = FALSE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{col_name}}{The metaData column of categorical variables to create a ggplot object.}

\item{\code{method}}{Diversity metric such as "shannon", "invsimpson" or "simpson"}

\item{\code{Brewer.palID}}{Palette set to be applied, see \link[RColorBrewer]{brewer.pal} or \link[OmicFlow]{fetch_palette}.}

\item{\code{evenness}}{A boolean wether to divide diversity by number of species, see \link[vegan]{specnumber}.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A \link[ggplot2]{ggplot} object.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"
plt <- obj$alpha_diversity(col_name = "treatment",
                           method = "shannon")

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-composition"></a>}}
\if{latex}{\out{\hypertarget{method-tools-composition}{}}}
\subsection{Method \code{composition()}}{
Visualization of compositional data.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$composition(
  feature_rank,
  feature_filter = NA,
  col_name = NA,
  sample.id = "SAMPLE-ID",
  feature_top = 10,
  Brewer.palID = "RdYlBu"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature_rank}}{A featureData column name to visualize.}

\item{\code{feature_filter}}{Removes features by name, works on single strings or vector of strings.}

\item{\code{col_name}}{A metaData column name to add to the compositional data.}

\item{\code{sample.id}}{A metaData column specifying the sample.id, used to filter out NAs if col_name is specified.}

\item{\code{feature_top}}{Integer of the top features to visualize, the max is 15, due to a limit of palettes.}

\item{\code{Brewer.palID}}{Palette set to be applied, see \link[RColorBrewer]{brewer.pal} or \link[OmicFlow]{fetch_palette}.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A long \link[data.table]{data.table} table.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

result <- obj$composition(feature_rank = "Genus",
                          feature_filter = c("uncultured"),
                          feature_top = 10)

plt <- composition_plot(data = result$data,
                        palette = result$palette,
                        feature_rank = "Genus")

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-ordination"></a>}}
\if{latex}{\out{\hypertarget{method-tools-ordination}{}}}
\subsection{Method \code{ordination()}}{
Ordination of countData with statistical tests.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$ordination(
  metric = c("bray", "jaccard", "unifrac"),
  method = c("pcoa", "nmds"),
  group_by,
  distmat = NULL,
  weighted = FALSE,
  normalize = TRUE,
  parallel = FALSE,
  pca.pairwise = FALSE,
  pca.max.explained = 80,
  pca.dim = c(1, 2),
  outdir = ".",
  cpus = 8,
  sample.id = "SAMPLE-ID"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{metric}}{A dissimilarity or similarity metric to be applied on the countData, thus far supports 'bray', 'jaccard' and 'unifrac' column name to visualize.}

\item{\code{method}}{Ordination method, supports "pcoa" and "nmds".}

\item{\code{group_by}}{A metaData column to be used as contrast for PERMANOVA or ANOSIM statistical test.}

\item{\code{distmat}}{A custom distance matrix in \link[stats]{dist} format.}

\item{\code{weighted}}{Boolean, wether to compute weighted or unweighted dissimilarities.}

\item{\code{normalize}}{Boolean, wether to normalize by total sample sums.}

\item{\code{parallel}}{Boolean, wether to parallelize the computation of the dissimilarity matrix.}

\item{\code{pca.pairwise}}{Boolean, wether to visualize different combinations of the principal components, only works with method 'pcoa'.}

\item{\code{pca.max.explained}}{Integer specifying the maximum number of dissimilarity explained, used in pca.pairwise, default is 80, max number of dimensions is 15.}

\item{\code{pca.dim}}{Vector with integers, specifying what dimensions to visualize in case of pca.pairwise is FALSE.}

\item{\code{outdir}}{Output directory of pca.pairwise, outputs a pdf document.}

\item{\code{cpus}}{Integer, number of cores to use. Default is 8 when parallelize is TRUE.}

\item{\code{sample.id}}{A metaData column specifying the sample.id, used to filter out NAs from \code{group_by} column name.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A list of \link[ggplot2]{ggplot} object.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

pcoa_plots <- obj$ordination(metric = "bray",
                             method = "pcoa",
                             group_by = "treatment",
                             sample.id = "SAMPLE-ID",
                             weighted = TRUE,
                             parallel = TRUE,
                             normalize = TRUE)
pcoa_plots

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-differential_feature_expression"></a>}}
\if{latex}{\out{\hypertarget{method-tools-differential_feature_expression}{}}}
\subsection{Method \code{differential_feature_expression()}}{
Differential feature expression
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$differential_feature_expression(
  feature_rank,
  sample.id,
  paired = FALSE,
  paired.id,
  condition.group,
  condition_A,
  condition_B,
  pvalue.threshold = 0.05,
  foldchange.threshold = 0.06,
  feature_filter = NA,
  feature_top = NA,
  normalize = TRUE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature_rank}}{A featureData column name to visualize.}

\item{\code{sample.id}}{A metaData column specifying the sample.id, used to filter out NAs from \code{condition.group} column name.}

\item{\code{paired}}{Boolean, wether to compute paired or unpaired log2 fold change, for paired it is required to specify paired.id. Default is unpaired.}

\item{\code{paired.id}}{A metaData column name containing paired ids.}

\item{\code{condition.group}}{A metaData column name of where the conditions A and B are located.}

\item{\code{condition_A}}{A character string or vector.}

\item{\code{condition_B}}{A character string or vector.}

\item{\code{pvalue.threshold}}{Integer, a P-value threshold to label and color significant features. Default is 0.05.}

\item{\code{foldchange.threshold}}{Integer, a fold-change threshold to label and color significantly expressed features. Default is 0.06}

\item{\code{feature_filter}}{Removes features by name, works on single strings or vector of strings.}

\item{\code{feature_top}}{Integer of the top features to visualize, the max is 15, due to a limit of palettes.}

\item{\code{normalize}}{Boolean, wether to normalize by total sample sums.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
\itemize{
\item A list of \link[ggplot2]{ggplot} object.
\item A long \link[data.table]{data.table} table.
}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

unpaired <- obj$differential_feature_expression(feature_rank = "Genus",
                                                sample.id = "SAMPLE-ID",
                                                paired = FALSE,
                                                condition.group = "treatment",
                                                condition_A = c("H"),
                                                condition_B = c("T"))

paired <- obj$differential_feature_expression(feature_rank = "Genus",
                                              sample.id = "SAMPLE-ID",
                                              paired = TRUE,
                                              condition.group = "cycle",
                                              condition_A = c("t2", "t3"),
                                              condition_B = c("t1", "t2"),
                                              feature_top = 20)

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-triplot"></a>}}
\if{latex}{\out{\hypertarget{method-tools-triplot}{}}}
\subsection{Method \code{triplot()}}{
Computation and visualization of regression models
Thus far it contains triplot for RDA, should be modified to perform a standard regression and then optionally also visualize RDA.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$triplot(
  feature_rank,
  feature_filter = NA,
  metadata.col = NA,
  sample.id = "SAMPLE-ID",
  choice_dim = c("RDA1", "PC1"),
  pairwise = FALSE,
  Brewer.palID = "Set2",
  counts.scalar = 1
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature_rank}}{A featureData column name to visualize.}

\item{\code{feature_filter}}{Removes features by name, works on single strings or vector of strings.}

\item{\code{metadata.col}}{A metaData column that will be used as contrast. Multiple columns are not yet supported.}

\item{\code{sample.id}}{A metaData column specifying the sample.id, used to filter out NAs from \code{metadata.col} column name.}

\item{\code{choice_dim}}{A character vector to visualize which dimensions, default \code{c("RDA1", "PC1")}.}

\item{\code{pairwise}}{A boolean variable, if TRUE it will perform pairwise visualization of PCA and outputs it as a pdf file.}

\item{\code{Brewer.palID}}{Palette set to be applied, see \link[RColorBrewer]{brewer.pal} or \link[OmicFlow]{fetch_palette}.}

\item{\code{counts.scalar}}{Adds a pseudocount to countData prior to log transformation.}

\item{\code{feature_top}}{Integer of the top features to visualize, the max is 15, due to a limit of palettes.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A \link[ggplot2]{ggplot} object.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-correlation"></a>}}
\if{latex}{\out{\hypertarget{method-tools-correlation}{}}}
\subsection{Method \code{correlation()}}{
Correlation Analysis, default spearm and automatic filter & Visualization based on thresholds
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$correlation(
  feature_rank,
  feature_filter = NA,
  sample.id = "SAMPLE-ID",
  cor_method = "spearman",
  cor_columns = c("BMI", "Weight"),
  cor_threshold = 0.6,
  normalize = TRUE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature_rank}}{A featureData column name to visualize.}

\item{\code{feature_filter}}{Removes features by name, works on single strings or vector of strings.}

\item{\code{sample.id}}{A metaData column specifying the sample.id, used to filter out NAs from \code{cor_columns} column name.}

\item{\code{cor_method}}{Correlation method, default spearman, see \link[stats]{cor}.}

\item{\code{cor_columns}}{A vector of a single or multiple column names with continuous data.}

\item{\code{cor_threshold}}{Float variable, used to filter taxa that meet the cor_threshold in both positive as negative values. Default is 0.6.}

\item{\code{normalize}}{Boolean, wether to normalize by total sample sums.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A \link[ggplot2]{ggplot} object or \code{NULL} when no matches are found.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{obj <- tools$new(countData = "counts.csv",
                 featureData = "features.txt",
                 metaData = "metadata.tsv"

plt <- obj$correlation(feature_rank = "Genus",
                       feature_filter = c("uncultured"),
                       sample.id = "SAMPLE-ID",
                       cor_method = "spearman",
                       cor_columns = c("BMI", "weight", "flight.time"),
                       cor_threshold = 0.8)

}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-label_phylo"></a>}}
\if{latex}{\out{\hypertarget{method-tools-label_phylo}{}}}
\subsection{Method \code{label_phylo()}}{
Relabelling phylogenetic tree by featureData
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$label_phylo(feature_rank)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature_rank}}{A featureData column name to visualize.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A re-labelled tree as \link\link{ape} object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-tools-autoFlow"></a>}}
\if{latex}{\out{\hypertarget{method-tools-autoFlow}{}}}
\subsection{Method \code{autoFlow()}}{
Automated Omics Analysis based on metadata template.
For now only works with headers "RANKSTAT_" and "CORRELATION_".
Samples should be as "SAMPLE-ID" upper or lower case.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{tools$autoFlow(
  feature_ranks = c("Phylum", "Family", "Genus"),
  feature_filter = c("uncultured"),
  distance_metrics = c("unifrac"),
  dist_matrix = NA,
  alpha_div_table = NA,
  cpus = 1
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{feature_ranks}}{A character vector of features to use, default \code{c("Phylum", "Family", "Genus")}.}

\item{\code{feature_filter}}{A character vector of to filter unwanted taxa, default \code{c("uncultured")}}

\item{\code{distance_metrics}}{A character vector specifying what (dis)similarity metrics to use, default \code{c("unifrac")}}

\item{\code{dist_matrix}}{A path to pre-computed distance matrix, expects tsv/csv/txt file from qiime2.}

\item{\code{alpha_div_table}}{A path to pre-computed alpha diversity with rarefraction depth, expects tsv/csv/txt from qiime2.}

\item{\code{cpus}}{Number of cores to use, only used in \link[tools]{ordination} when dist_matrix is not supplied.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A nested list of \link[ggplot2]{ggplot} objects.
}
}
}
